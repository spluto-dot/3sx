/**
 * @file bbbscom.c
 * "Parry/Block the Ball!" Bonus Stage
 */

#include "sf33rd/Source/Game/engine/bbbscom.h"
#include "common.h"
#include "sf33rd/Source/Game/WORK_SYS.h"
#include "sf33rd/Source/Game/effect/eff16.h"
#include "sf33rd/Source/Game/effect/effb1.h"
#include "sf33rd/Source/Game/effect/effh0.h"
#include "sf33rd/Source/Game/effect/effh9.h"
#include "sf33rd/Source/Game/effect/effi8.h"
#include "sf33rd/Source/Game/engine/grade.h"
#include "sf33rd/Source/Game/engine/plcnt.h"
#include "sf33rd/Source/Game/engine/workuser.h"

const s32 bbbs_jump_level[4][2];

void bbbs_com_execute(PLW* wk) {
    switch (Bonus_Stage_RNO[0]) {
    case 0:
        if (Allow_a_battle_f == 0) {
            break;
        }

        Bonus_Stage_Tix = 0;
        Bonus_Stage_RNO[0] = 1;

        if ((wk->wu.dir_timer = bbbs_table[bbbs_type][Bonus_Stage_Level][Bonus_Stage_Tix].timer)) {
            Bonus_Stage_RNO[1] = 1;
        } else {
            Bonus_Stage_RNO[1] = 2;
        }

        wk->zettai_muteki_flag = true;
        effect_B1_init(wk, 0);
        effect_B1_init(wk, 1);
        effect_16_init(wk, 0);
        effect_16_init(wk, 1);
        effect_H9_init(wk);
        effect_H0_init(&wk->wu);
        break;

    case 1:
        switch (Bonus_Stage_RNO[1]) {
        case 0:
            if (wk->wu.routine_no[1] != 0) {
                break;
            }

            if (wk->wu.routine_no[2] != 1 && (wk->wu.routine_no[2] < 36 || wk->wu.routine_no[2] > 38)) {
                break;
            }

            Bonus_Stage_Tix++;

            if (bbbs_table[bbbs_type][Bonus_Stage_Level][Bonus_Stage_Tix].timer == -1) {
                Bonus_Stage_RNO[0] = 2;
                Bonus_Stage_RNO[1] = 0;
                break;
            }

            if ((wk->wu.dir_timer = bbbs_table[bbbs_type][Bonus_Stage_Level][Bonus_Stage_Tix].timer)) {
                if (bbbs_table[bbbs_type][Bonus_Stage_Level][Bonus_Stage_Tix].kosuu) {
                    Bonus_Stage_RNO[1] = 1;
                    break;
                } else {
                    Bonus_Stage_RNO[1] = 5;
                    break;
                }
            } else {
                if (bbbs_table[bbbs_type][Bonus_Stage_Level][Bonus_Stage_Tix].kosuu) {
                    Bonus_Stage_RNO[1] = 2;
                    break;
                } else {
                    Bonus_Stage_RNO[1] = 6;
                    break;
                }
            }

            break;

        case 1:
            if (--wk->wu.dir_timer < 1) {
                Bonus_Stage_RNO[1] = 2;
            }

            break;

        case 2:
            Bonus_Stage_RNO[1] = 3;
            wk->wu.routine_no[1] = 4;
            wk->wu.routine_no[2] = 31;
            wk->wu.routine_no[3] = 0;
            wk->wu.char_index = 71;
            wk->wu.cmwk[5] = bbbs_table[bbbs_type][Bonus_Stage_Level][Bonus_Stage_Tix].kosuu;
            wk->wu.mvxy.d[0].sp = 0;
            wk->wu.mvxy.a[0].sp = 0;
            wk->wu.mvxy.a[1].sp = bbbs_jump_level[bbbs_table[bbbs_type][Bonus_Stage_Level][Bonus_Stage_Tix].jmplv][0];
            wk->wu.mvxy.d[1].sp = bbbs_jump_level[bbbs_table[bbbs_type][Bonus_Stage_Level][Bonus_Stage_Tix].jmplv][1];
            break;

        case 3:
            if (wk->wu.cg_type == 20) {
                wk->wu.cg_type = 0;
                setup_effI8(wk, &bbbs_table[bbbs_type][Bonus_Stage_Level][Bonus_Stage_Tix]);
                Bonus_Stage_RNO[1] = 4;
            }

            break;

        case 4:
            if (wk->wu.routine_no[1] == 4 && wk->wu.routine_no[2] == 31 && wk->wu.routine_no[3] == 3) {
                Bonus_Stage_RNO[1] = 0;
            }

            break;

        case 5:
            if (--wk->wu.dir_timer < 1) {
                Bonus_Stage_RNO[1] = 6;
                Allow_a_battle_f = 0;
            }

            break;

        case 6:
            Bonus_Stage_RNO[0] = 2;
            Bonus_Stage_RNO[1] = 0;
            Allow_a_battle_f = 0;
            break;
        }

    case 2:
        break;
    }
}

void bbbs_com_initialize() {
    Bonus_Stage_RNO[0] = Bonus_Stage_RNO[1] = 0;
    Bonus_Stage_RNO[2] = Bonus_Stage_RNO[3] = 0;
}

void makeup_bonus_game_level(s16 ix) {
    s16 emid = (ix + 1) & 1;
    u16 swdat;

    if (emid) {
        swdat = p2sw_0;
    } else {
        swdat = p1sw_0;
    }

    bbbs_type = 1;

    if (katteni_bonus_nando(swdat)) {
        Bonus_Stage_Level = set_bonus_game_nando(swdat);

        if (Bonus_Stage_Level > 4) {
            bbbs_type = 0;
            Bonus_Stage_Level -= 5;
        }
    } else {
        Bonus_Stage_Level = set_bonus_game_difficulty(emid);
    }
}

s32 set_bonus_game_difficulty(s16 emid) {
    s16 grade = judge_final[emid][0].vs_cpu_grade[11];

    if (grade < 9) {
        return 0;

    } else if (grade < 15) {
        return 1;

    } else if (grade < 18) {
        return 2;

    } else if (grade < 21) {
        return 3;

    } else {
        return 4;
    }
}

s32 set_bonus_game_nando(u16 swdat) {
    if (swdat == 0x252) {
        return 9;
    }

    if (swdat == 0x702) {
        return 8;
    }

    if (swdat == 0x402) {
        return 7;
    }

    if (swdat == 0x202) {
        return 6;
    }

    if (swdat == 0x102) {
        return 5;
    }

    if (swdat == 0x521) {
        return 4;
    }

    if (swdat == 0x71) {
        return 3;
    }

    if (swdat == 0x41) {
        return 2;
    }

    if (swdat == 0x21) {
        return 1;
    }

    return 0;
}

s32 katteni_bonus_nando(u16 swdat) {
    if (swdat & 1 && swdat & 0x70) {
        return 1;
    }

    if (swdat & 2 && swdat & 0x700) {
        return 1;
    }

    return 0;
}

const s32 bbbs_jump_level[4][2] = {
    { 0x00030000, 0xFFFFD000 },
    { 0x00038000, 0xFFFFD000 },
    { 0x00040000, 0xFFFFD000 },
    { 0x00048000, 0xFFFFD000 },
};

const BBBSTable bbbs_level_00[18] = {
    { 100, 3, 1, { { 10, 45, 2, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 50, 2, 1, { { 10, 45, 2, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 40, 1, 1, { { 10, 45, 2, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 30, 1, 1, { { 10, 45, 3, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 30, 1, 1, { { 10, 45, 3, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 20, 1, 1, { { 10, 45, 3, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 20, 1, 1, { { 10, 45, 3, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 20, 1, 1, { { 10, 45, 3, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 10, 1, 1, { { 10, 45, 3, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 10, 1, 1, { { 12, 40, 3, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 10, 0, 1, { { 12, 35, 3, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 5, 0, 1, { { 10, 30, 2, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 40, 1, 2, { { 10, 48, 4, 16 }, { 16, 48, 4, 16 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 40, 1, 2, { { 10, 44, 4, 8 }, { 14, 44, 4, 8 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 30, 2, 2, { { 12, 44, 3, 0 }, { 12, 44, 3, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 40, 2, 2, { { 12, 30, 2, 0 }, { 12, 30, 2, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 90, 0, 0, { { 0, 0, 3, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { -1, 0, 0, { { 0, 0, 3, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } }
};

const BBBSTable bbbs_level_01[16] = {
    { 100, 3, 1, { { 14, 44, 3, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 40, 3, 1, { { 12, 44, 3, 8 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 35, 2, 1, { { 12, 40, 3, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 30, 2, 1, { { 10, 40, 3, 8 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 25, 1, 1, { { 10, 36, 3, -8 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 20, 1, 1, { { 10, 36, 3, -8 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 10, 0, 1, { { 10, 34, 3, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 5, 0, 1, { { 10, 32, 2, 8 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 5, 0, 1, { { 10, 32, 2, -16 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 40, 3, 2, { { 10, 40, 3, 0 }, { 14, 40, 4, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 30, 1, 2, { { 10, 36, 3, 8 }, { 14, 36, 4, 8 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 30, 1, 2, { { 12, 32, 4, 0 }, { 12, 42, 2, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 20, 1, 2, { { 12, 30, 2, 8 }, { 12, 30, 2, 8 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 40, 2, 3, { { 12, 30, 5, -16 }, { 12, 36, 5, -16 }, { 12, 42, 5, -16 }, { 0, 0, 0, 0 } } },
    { 90, 0, 0, { { 0, 0, 3, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { -1, 0, 0, { { 0, 0, 3, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } }
};

const BBBSTable bbbs_level_02[15] = {
    { 100, 3, 1, { { 14, 40, 2, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 20, 3, 1, { { 12, 36, 2, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 20, 2, 1, { { 10, 32, 2, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 10, 1, 1, { { 10, 28, 3, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 10, 0, 1, { { 14, 50, 4, 8 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 5, 0, 1, { { 10, 40, 3, 16 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 5, 0, 1, { { 10, 26, 2, -8 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 10, 3, 1, { { 14, 26, 1, 8 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 30, 3, 2, { { 10, 40, 3, -8 }, { 10, 45, 3, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 20, 2, 2, { { 10, 30, 2, 0 }, { 12, 50, 4, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 20, 1, 2, { { 10, 40, 4, 0 }, { 14, 40, 4, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 30, 3, 3, { { 12, 35, 4, -16 }, { 14, 35, 4, -8 }, { 12, 35, 4, 0 }, { 0, 0, 0, 0 } } },
    { 20, 2, 3, { { 10, 34, 4, 0 }, { 10, 32, 3, 8 }, { 10, 30, 2, 16 }, { 0, 0, 0, 0 } } },
    { 90, 0, 0, { { 0, 0, 3, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { -1, 0, 0, { { 0, 0, 3, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } }
};

const BBBSTable bbbs_level_03[13] = {
    { 100, 3, 1, { { 10, 40, 4, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 10, 2, 1, { { 10, 32, 3, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 10, 1, 1, { { 10, 24, 2, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 30, 0, 1, { { 14, 40, 3, 16 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 10, 1, 2, { { 10, 26, 2, 8 }, { 10, 30, 3, -8 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 5, 0, 1, { { 12, 40, 3, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 5, 1, 2, { { 12, 40, 4, 0 }, { 12, 36, 3, 8 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 5, 2, 3, { { 10, 30, 2, 8 }, { 10, 35, 3, 8 }, { 10, 40, 4, 8 }, { 0, 0, 0, 0 } } },
    { 30, 1, 2, { { 12, 24, 1, -8 }, { 12, 28, 2, -8 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 20, 2, 2, { { 12, 45, 4, 0 }, { 12, 45, 4, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 5, 3, 4, { { 10, 40, 4, 8 }, { 10, 36, 3, 8 }, { 10, 32, 2, 8 }, { 10, 28, 1, 8 } } },
    { 90, 0, 0, { { 0, 0, 3, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { -1, 0, 0, { { 0, 0, 3, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } }
};

const BBBSTable bbbs_level_04[11] = {
    { 100, 0, 1, { { 14, 50, 2, 16 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 5, 1, 2, { { 10, 35, 4, -8 }, { 10, 35, 3, -8 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 5, 1, 2, { { 10, 35, 5, 0 }, { 10, 30, 2, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 5, 1, 2, { { 12, 30, 2, 8 }, { 12, 40, 2, 8 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 5, 2, 3, { { 10, 26, 2, 8 }, { 10, 40, 2, 8 }, { 10, 50, 2, 8 }, { 0, 0, 0, 0 } } },
    { 5, 0, 2, { { 10, 30, 3, -8 }, { 10, 28, 2, -8 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 5, 2, 3, { { 10, 40, 4, 16 }, { 10, 35, 3, 8 }, { 10, 30, 2, 0 }, { 0, 0, 0, 0 } } },
    { 5, 3, 4, { { 10, 38, 5, 8 }, { 10, 46, 4, 8 }, { 10, 54, 3, 8 }, { 10, 62, 2, -8 } } },
    { 5, 0, 1, { { 12, 20, 1, -8 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 90, 0, 0, { { 0, 0, 3, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { -1, 0, 0, { { 0, 0, 3, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } }
};

const BBBSTable bbbs_level_05[18] = {
    { 100, 3, 1, { { 10, 45, 2, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 50, 2, 1, { { 9, 45, 2, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 40, 1, 1, { { 9, 45, 2, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 30, 1, 1, { { 9, 45, 3, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 30, 1, 1, { { 9, 45, 3, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 20, 1, 1, { { 9, 45, 3, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 20, 1, 1, { { 9, 45, 3, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 20, 1, 1, { { 9, 45, 3, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 10, 1, 1, { { 9, 45, 3, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 10, 1, 1, { { 11, 40, 3, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 10, 0, 1, { { 11, 38, 3, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 8, 0, 1, { { 12, 35, 2, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 40, 3, 2, { { 10, 50, 2, 0 }, { 20, 50, 2, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 36, 2, 2, { { 10, 45, 2, 4 }, { 18, 45, 2, 4 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 32, 1, 2, { { 12, 40, 3, 6 }, { 16, 40, 3, 6 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 28, 0, 2, { { 12, 36, 4, 8 }, { 14, 34, 4, 8 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 90, 0, 0, { { 0, 0, 3, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { -1, 0, 0, { { 0, 0, 3, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } }
};

const BBBSTable bbbs_level_06[16] = {
    { 100, 3, 1, { { 14, 44, 3, 8 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 40, 2, 1, { { 12, 40, 3, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 35, 2, 1, { { 12, 36, 3, 8 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 25, 1, 1, { { 10, 36, 3, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 20, 1, 1, { { 10, 32, 3, 4 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 15, 0, 1, { { 10, 32, 3, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 10, 0, 1, { { 10, 30, 2, -4 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 5, 0, 1, { { 10, 30, 2, -8 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 5, 0, 1, { { 10, 24, 1, -16 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 40, 3, 2, { { 10, 40, 3, 0 }, { 16, 40, 4, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 30, 1, 2, { { 10, 35, 3, 8 }, { 14, 35, 4, 8 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 25, 3, 2, { { 12, 30, 4, 0 }, { 12, 45, 3, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 20, 1, 2, { { 12, 30, 2, 8 }, { 12, 30, 1, 8 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 40, 2, 3, { { 12, 30, 5, -16 }, { 12, 36, 5, 8 }, { 12, 46, 5, -16 }, { 0, 0, 0, 0 } } },
    { 90, 0, 0, { { 0, 0, 3, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { -1, 0, 0, { { 0, 0, 3, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } }
};

const BBBSTable bbbs_level_07[17] = {
    { 100, 3, 1, { { 14, 40, 2, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 20, 3, 1, { { 12, 36, 2, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 20, 2, 1, { { 10, 32, 2, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 10, 1, 1, { { 10, 28, 3, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 4, 3, 1, { { 14, 92, 4, -16 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 5, 0, 1, { { 10, 26, 3, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 10, 0, 1, { { 8, 24, 4, -8 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 4, 0, 1, { { 8, 22, 1, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 2, 2, 1, { { 8, 46, 4, 16 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 1, 0, 1, { { 8, 22, 1, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 2, 1, 1, { { 8, 40, 4, 8 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 1, 0, 1, { { 4, 21, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 24, 2, 2, { { 10, 30, 2, 0 }, { 12, 50, 4, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 22, 3, 3, { { 12, 35, 4, -16 }, { 14, 35, 4, -8 }, { 12, 35, 4, 0 }, { 0, 0, 0, 0 } } },
    { 16, 2, 3, { { 10, 34, 4, 0 }, { 10, 32, 3, 8 }, { 10, 30, 2, 16 }, { 0, 0, 0, 0 } } },
    { 90, 0, 0, { { 0, 0, 3, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { -1, 0, 0, { { 0, 0, 3, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } }
};

const BBBSTable bbbs_level_08[11] = {
    { 100, 3, 1, { { 10, 40, 4, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 18, 1, 2, { { 10, 26, 2, 8 }, { 10, 30, 3, -8 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 4, 0, 1, { { 14, 20, 2, 16 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 10, 2, 3, { { 10, 44, 3, 0 }, { 10, 30, 2, 8 }, { 10, 17, 2, 16 }, { 0, 0, 0, 0 } } },
    { 8, 1, 2, { { 10, 35, 4, 8 }, { 10, 20, 1, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 5, 2, 3, { { 10, 30, 2, 8 }, { 10, 28, 3, 4 }, { 10, 26, 4, 0 }, { 0, 0, 0, 0 } } },
    { 25, 3, 4, { { 10, 40, 4, 8 }, { 10, 36, 3, 8 }, { 10, 32, 2, 8 }, { 10, 28, 1, 8 } } },
    { 5, 2, 3, { { 10, 30, 2, 8 }, { 10, 35, 3, 8 }, { 10, 40, 4, 8 }, { 0, 0, 0, 0 } } },
    { 19, 3, 1, { { 14, 26, 4, 128 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 90, 0, 0, { { 0, 0, 3, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { -1, 0, 0, { { 0, 0, 3, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } }
};

const BBBSTable bbbs_level_09[12] = {
    { 100, 0, 1, { { 14, 50, 2, 16 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 1, 1, 2, { { 8, 35, 4, -8 }, { 10, 35, 3, -8 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 1, 2, 3, { { 4, 24, 2, 0 }, { 10, 38, 2, 4 }, { 10, 21, 2, 8 }, { 0, 0, 0, 0 } } },
    { 23, 0, 1, { { 4, 34, 4, 128 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 5, 1, 2, { { 4, 30, 2, 8 }, { 10, 56, 2, 8 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 23, 1, 2, { { 4, 46, 4, 128 }, { 10, 22, 4, 128 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 5, 0, 1, { { 4, 28, 2, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 1, 2, 3, { { 4, 28, 2, 8 }, { 10, 33, 3, 8 }, { 10, 38, 4, 8 }, { 0, 0, 0, 0 } } },
    { 6, 0, 1, { { 8, 20, 1, -8 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { 1, 3, 4, { { 4, 50, 2, 128 }, { 10, 42, 2, 128 }, { 10, 32, 2, 128 }, { 10, 20, 2, 128 } } },
    { 90, 0, 0, { { 0, 0, 3, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } },
    { -1, 0, 0, { { 0, 0, 3, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 }, { 0, 0, 0, 0 } } }
};

const BBBSTable* bbbs_table[2][5] = { { bbbs_level_00, bbbs_level_01, bbbs_level_02, bbbs_level_03, bbbs_level_04 },
                                      { bbbs_level_05, bbbs_level_06, bbbs_level_07, bbbs_level_08, bbbs_level_09 } };
